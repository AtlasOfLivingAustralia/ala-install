- name: Install Apache2 (RedHat)
  yum: "name=httpd state=present"
  when: ansible_os_family == "RedHat"

- name: Start Apache2 (RedHat)
  service: name=httpd state=restarted
  when: ansible_os_family == "RedHat"

- name: Install Apache2 (Debian)
  apt: "pkg=apache2 state=present"
  when: ansible_os_family == "Debian"

- name: Enable mod_proxy_http (enables mod_proxy transitively)
  apache2_module: state=present name=proxy_http
  when: ansible_os_family == "Debian"

- name: Enable mod_proxy_ajp (enables mod_proxy transitively)
  apache2_module: state=present name=proxy_ajp
  when: ansible_os_family == "Debian"

- name: Create Apache virtual host config file
  template: src=apache-default-vhost.j2 dest=/etc/apache2/sites-available/000-default.conf owner=root group=root
  notify:
    - reload apache

#- name: Enable Apache virtual host
#  command: "a2ensite default-host.conf"
#  notify:
#    - reload apache

- name: Start Apache2 (Debian)
  service: name=apache2 state=restarted
  when: ansible_os_family == "Debian"
