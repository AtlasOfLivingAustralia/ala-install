---
# Ensure external named volumes exist for databases with la_ prefix
# This prevents accidental deletion of database data

- name: "Database volumes: Set Docker socket path"
  set_fact:
    docker_socket: "{{ lookup('env', 'DOCKER_HOST') | default('unix:///var/run/docker.sock') }}"
  tags:
    - db-init
    - docker-volumes

- name: "Database volumes: Create MySQL external volume"
  docker_volume:
    name: la_mysql-data
    driver: local
    docker_host: "{{ docker_socket }}"
    state: present
  tags:
    - db-init
    - docker-volumes

- name: "Database volumes: Create PostgreSQL external volume"
  docker_volume:
    name: la_postgres-data
    driver: local
    docker_host: "{{ docker_socket }}"
    state: present
  tags:
    - db-init
    - docker-volumes

- name: "Database volumes: Create MongoDB external volume"
  docker_volume:
    name: la_mongodb-data
    driver: local
    docker_host: "{{ docker_socket }}"
    state: present
  tags:
    - db-init
    - docker-volumes

- name: "Database volumes: Create Gatus external volume"
  docker_volume:
    name: la_gatus-data
    driver: local
    docker_host: "{{ docker_socket }}"
    state: present
  tags:
    - db-init
    - docker-volumes











