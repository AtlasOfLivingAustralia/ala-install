---
# Docker Common Role Defaults
# Using existing ala-install variable patterns

# Deployment type (existing from PR #675)
deployment_type: vm  # Options: vm, container, swarm
deployment_env: production  # Options: dev, staging, production

# Build configuration
build_images: false  # Set to true to build from source instead of pulling from registry
docker_registry: ""  # Empty means local builds, set to registry URL for push/pull

# Docker image tagging strategy:
# Priority: 1) collectory_branch (for git branches like 'develop')
#           2) collectory_version (for releases like '5.2.0')
#           3) Default: 'develop'
# This allows flexibility: use branches for dev, versions for production
docker_tag: "{{ collectory_branch | default(collectory_version | default('develop')) }}"
docker_image_tag: "{{ docker_tag }}"  # Alias for docker_tag
docker_cache_tag: "buildcache"  # Cache tag for layer caching

# Docker build cache directory (persistent across builds)
# Using ~/.cache/docker-buildx instead of /tmp for persistence
docker_build_cache_dir: "{{ ansible_env.HOME }}/.cache/docker-buildx"

# Docker network configuration (existing from PR #675)
docker_network: la_internal
docker_network_mtu: 1500

# Services to enable (determines which services are included in docker-compose.yml)
services_enabled: []
  # - nginx
  # - collectory
  # - biocache-service
  # - bie-hub
  # etc.

# i18n configuration
# See I18N_DOCKER_STRATEGIES.md for detailed explanation
i18n:
  enabled: true
  # Strategy options:
  #   - 'host-mount': (RECOMMENDED) Reuses Ansible i18n role, mounts /opt/atlas/i18n from host
  #                   Requires i18n role to be run on the host first
  #   - 'volume':     Uses Docker volume with init-container (portable but duplicates Ansible logic)
  strategy: host-mount
  volume:
    name: ala-i18n-data
    source: init-container  # Only used when strategy='volume'

# Nginx configuration (existing variables)
nginx_conf_dir: "{{ data_dir }}/nginx"
nginx_user: nginx

# Data directories (existing variable)
data_dir: /opt/docker-compose

# Monitoring (existing from gatus role)
monitoring_enabled: false

# Deprecated variables (no longer used in container deployment)
i18n_package_enabled: false  # Replaced by i18n.strategy

# Docker services configuration - mapping of service names, artifacts, repos, and versions
# Based on la-toolkit LAServiceDesc structure
# https://github.com/living-atlases/la-toolkit/blob/master/lib/src/la_service_desc.dart
docker_services_config:
  collectory:
    description: "ALA Collectory - Specimen collection registry"
    artifact_id: "collectory"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "17"
    runtime_image: "tomcat:9-jre17"
    repo: "https://github.com/AtlasOfLivingAustralia/collectory.git"
    branch: "develop"
    port: 8080
    classifier: ""
    version_variable: "collectory_version"
    enabled_by: "use_collectory"

  cas:
    description: "Central Authentication Service"
    artifact_id: "cas"
    group_id: "au.org.ala"
    build_tool: "maven"
    java_version: "11"
    runtime_image: "eclipse-temurin:11-jre-jammy"
    repo: "https://github.com/AtlasOfLivingAustralia/ala-cas-5.git"
    branch: "master"
    port: 8080
    classifier: "exec"
    version_variable: "cas_version"
    enabled_by: "use_cas"

  userdetails:
    description: "User Details - User profiles and authentication"
    artifact_id: "userdetails"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "11"
    runtime_image: "tomcat:9-jre11"
    repo: "https://github.com/AtlasOfLivingAustralia/userdetails.git"
    branch: "master"
    port: 8080
    classifier: "exec"
    version_variable: "user_details_version"
    enabled_by: "use_cas"

  apikey:
    description: "API Key Service"
    artifact_id: "apikey"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "11"
    runtime_image: "tomcat:9-jre11"
    repo: "https://github.com/AtlasOfLivingAustralia/apikey.git"
    branch: "master"
    port: 8080
    classifier: "exec"
    version_variable: "apikey_version"
    enabled_by: "use_cas"

  cas-management:
    description: "CAS Management Service"
    artifact_id: "cas-management"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "11"
    runtime_image: "eclipse-temurin:11-jre-jammy"
    repo: "https://github.com/AtlasOfLivingAustralia/ala-cas-5-services.git"
    branch: "master"
    port: 8080
    classifier: "exec"
    version_variable: "cas_management_version"
    enabled_by: "use_cas"

  species-lists:
    description: "Species Lists - User-provided species lists"
    artifact_id: "specieslist-webapp"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "11"
    runtime_image: "tomcat:9-jre11"
    repo: "https://github.com/AtlasOfLivingAustralia/specieslist-webapp.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "species_list_version"
    enabled_by: "use_species_lists"

  ala-bie:
    description: "ALA BIE - Species search frontend"
    artifact_id: "ala-bie-hub"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "17"
    runtime_image: "tomcat:9-jre17"
    repo: "https://github.com/AtlasOfLivingAustralia/ala-bie-hub.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "bie_hub_version"
    enabled_by: "use_ala_bie"

  spatial:
    description: "Spatial Hub - Spatial features frontend"
    artifact_id: "spatial-hub"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "17"
    runtime_image: "tomcat:9-jre17"
    repo: "https://github.com/AtlasOfLivingAustralia/spatial-hub.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "spatial_hub_version"
    enabled_by: "use_spatial"

  regions:
    description: "Regions - Regional data frontend"
    artifact_id: "regions"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "17"
    runtime_image: "tomcat:9-jre17"
    repo: "https://github.com/AtlasOfLivingAustralia/regions.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "regions_version"
    enabled_by: "use_regions"

  species:
    description: "Species (BIE Index) - Species web service"
    artifact_id: "bie-index"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "17"
    runtime_image: "tomcat:9-jre17"
    repo: "https://github.com/AtlasOfLivingAustralia/bie-index.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "bie_index_version"
    enabled_by: "use_species"

  images:
    description: "Image Service"
    artifact_id: "image-service"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "17"
    runtime_image: "tomcat:9-jre17"
    repo: "https://github.com/AtlasOfLivingAustralia/image-service.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "image_service_version"
    enabled_by: "use_images"

  alerts:
    description: "Alerts Service - User notifications"
    artifact_id: "alerts"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "11"
    runtime_image: "tomcat:9-jre11"
    repo: "https://github.com/AtlasOfLivingAustralia/alerts.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "alerts_version"
    enabled_by: "use_alerts"

  doi:
    description: "DOI Service"
    artifact_id: "doi-service"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "11"
    runtime_image: "tomcat:9-jre11"
    repo: "https://github.com/AtlasOfLivingAustralia/doi-service.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "doi_service_version"
    enabled_by: "use_doi"

  dashboard:
    description: "Dashboard - Portal statistics"
    artifact_id: "dashboard"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "11"
    runtime_image: "tomcat:9-jre11"
    repo: "https://github.com/AtlasOfLivingAustralia/dashboard.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "dashboard_version"
    enabled_by: "use_dashboard"

  biocache-backend:
    description: "Biocache Backend - Occurrence data storage and indexing"
    build_tool: "none"
    source_type: "infrastructure"
    enabled_by: "use_biocache_backend"

  pipelines:
    description: "Pipelines - Data processing and indexing"
    build_tool: "none"
    source_type: "infrastructure"
    enabled_by: "use_pipelines"

  solrcloud:
    description: "SolrCloud - Distributed search"
    build_tool: "none"
    source_type: "infrastructure"
    enabled_by: "use_solrcloud"

  sds:
    description: "SDS - Sensitive Data Service"
    artifact_id: "sds-webapp2"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "11"
    runtime_image: "tomcat:9-jre11"
    repo: "https://github.com/AtlasOfLivingAustralia/sds.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "sds_version"
    enabled_by: "use_sds"

  biocollect:
    description: "BioCollect - Data collection tool"
    artifact_id: "biocollect"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "17"
    runtime_image: "tomcat:9-jre17"
    repo: "https://github.com/AtlasOfLivingAustralia/biocollect.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "biocollect_version"
    enabled_by: "use_biocollect"

  namematching:
    description: "Name Matching Service"
    artifact_id: "namematching-service"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "11"
    runtime_image: "tomcat:9-jre11"
    repo: "https://github.com/AtlasOfLivingAustralia/namematching-service.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "ala_namematching_service_version"
    enabled_by: "use_namematching_service"

  sensitive-data:
    description: "Sensitive Data Service - Web services for sensitive data"
    artifact_id: "sensitive-data-service"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "11"
    runtime_image: "tomcat:9-jre11"
    repo: "https://github.com/AtlasOfLivingAustralia/sensitive-data-service.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "ala_sensitive_data_service_version"
    enabled_by: "use_sensitive_data_service"

  data-quality:
    description: "Data Quality Filter Service"
    artifact_id: "data-quality-filter-service"
    group_id: "au.org.ala"
    build_tool: "gradle"
    java_version: "11"
    runtime_image: "tomcat:9-jre11"
    repo: "https://github.com/AtlasOfLivingAustralia/data-quality-filter-service.git"
    branch: "master"
    port: 8080
    classifier: ""
    version_variable: "data_quality_filter_service_version"
    enabled_by: "use_data_quality"

  events-elasticsearch:
    description: "Events Elasticsearch - Elasticsearch for events"
    build_tool: "none"
    source_type: "infrastructure"
    enabled_by: "use_events_elasticsearch"

# Docker output directory for generated Dockerfiles
docker_output_dir: "{{ docker_compose_output_dir | default('docker-compose-output') }}"
